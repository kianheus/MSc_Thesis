(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     46887,       1221]
NotebookOptionsPosition[     43335,       1157]
NotebookOutlinePosition[     43724,       1173]
CellTagsIndexPosition[     43681,       1170]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Define", " ", "joint", " ", "angles", " ", "q", " ", "and", " ", 
    "derivatives", " ", 
    RowBox[{"qDot", "."}]}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"q", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"q0", "[", "t", "]"}], ",", " ", 
       RowBox[{"q1", "[", "t", "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"qDot", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"q", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", "t"}], "]"}], ",", " ", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"q", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", " ", "t"}], "]"}]}], "}"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.938185601956435*^9, 3.938186121743247*^9, {3.950773805016431*^9, 
   3.950773805617366*^9}, {3.950773843052548*^9, 3.9507738834530287`*^9}, {
   3.9507782378421383`*^9, 3.9507782378815937`*^9}, {3.950779199972458*^9, 
   3.9507792055844183`*^9}, {3.9507798496791563`*^9, 3.9507798557970963`*^9}, 
   3.955344287595417*^9},
 CellLabel->"In[3]:=",ExpressionUUID->"47abae8b-9a77-408c-b4af-bc57d2c86ead"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"x", ",", 
    RowBox[{
     RowBox[{
     "y", " ", "position", " ", "of", " ", "elbow", " ", "and", " ", "end"}], 
     "-", 
     RowBox[{"effector", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"x0", "=", 
     RowBox[{"l0", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       "]"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"y0", "=", 
     RowBox[{"l0", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       "]"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"x1", "=", 
     RowBox[{
      RowBox[{"l0", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}]}], "+", 
      RowBox[{"l1", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"q", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "]"}]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"y1", "=", 
     RowBox[{
      RowBox[{"l0", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}]}], "+", 
      RowBox[{"l1", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"q", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "]"}]}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.95077823577631*^9, 3.950778235827306*^9}, {
  3.954487453416909*^9, 3.9544874581828938`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"d318ab64-df89-41e4-88c1-260881541004"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"x", ",", 
    RowBox[{
     RowBox[{
     "y", " ", "velocity", " ", "of", " ", "elbow", " ", "and", " ", "end"}], 
     "-", 
     RowBox[{"effector", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"vx0", "=", 
     RowBox[{"D", "[", 
      RowBox[{"x0", ",", "t"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"vy0", "=", 
     RowBox[{"D", "[", 
      RowBox[{"y0", ",", "t"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"vx1", "=", 
     RowBox[{"D", "[", 
      RowBox[{"x1", ",", "t"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"vy1", "=", 
     RowBox[{"D", "[", 
      RowBox[{"y1", ",", "t"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.950778231930709*^9, 3.950778232046892*^9}, {
  3.954487463221479*^9, 3.9544874749266768`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"610ec9d0-2acf-46c2-8994-20be09315927"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "K", " ", "is", " ", "the", " ", "vector", " ", "from", " ", "origin", 
     " ", "to", " ", "end"}], "-", 
    RowBox[{"effector", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"K", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"x1", ",", " ", "y1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Define", " ", "R", " ", "as", " ", "the", " ", "vector", " ", "between",
       " ", "actuator", " ", "and", " ", "end"}], "-", 
     RowBox[{"effector", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Rx", " ", "=", " ", 
     RowBox[{"xa", " ", "-", " ", 
      RowBox[{"K", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ry", " ", "=", " ", 
     RowBox[{"ya", " ", "-", " ", 
      RowBox[{"K", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"R", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "Rx", "}"}], ",", " ", 
      RowBox[{"{", "Ry", "}"}]}], "}"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"l", " ", "is", " ", "the", " ", "length", " ", "of", " ", "R"}],
      ",", " ", 
     RowBox[{"and", " ", "alpha", " ", "the", " ", "angle", " ", "of", " ", 
      RowBox[{"R", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"l", " ", "=", " ", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"Rx", "^", "2"}], " ", "+", " ", 
       RowBox[{"Ry", "^", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"alpha", " ", "=", " ", 
     RowBox[{"ArcTan", "[", 
      RowBox[{"Rx", ",", " ", "Ry"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.938186330795827*^9, 3.938186331521819*^9}, {
   3.938186473729291*^9, 3.938186707060857*^9}, {3.9381867386500072`*^9, 
   3.9381868699606752`*^9}, {3.939113056035419*^9, 3.9391130759058027`*^9}, {
   3.950773893073658*^9, 3.95077391117505*^9}, {3.950777892657567*^9, 
   3.950777895466133*^9}, {3.950777970308415*^9, 3.9507779777594137`*^9}, {
   3.950778034619894*^9, 3.950778045394538*^9}, {3.950778205938137*^9, 
   3.950778279054994*^9}, {3.95077848765387*^9, 3.9507784999367323`*^9}, {
   3.951828825357419*^9, 3.951828843263698*^9}, {3.954487478099101*^9, 
   3.9544874797808113`*^9}, {3.955101407883905*^9, 3.955101410945465*^9}, 
   3.955102489476125*^9, {3.95518664684028*^9, 3.955186657376667*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"9eec63cc-bd4b-4469-8473-5eea612c1986"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"xa", "-", 
     RowBox[{"l0", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"q0", "[", "t", "]"}], "]"}]}], "-", 
     RowBox[{"l1", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"q1", "[", "t", "]"}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"ya", "-", 
     RowBox[{"l0", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"q0", "[", "t", "]"}], "]"}]}], "-", 
     RowBox[{"l1", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"q1", "[", "t", "]"}], "]"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.9551026015299*^9, 3.955186589089857*^9, 
  3.955186697462509*^9, 3.955187740134242*^9, 3.95518782521204*^9, 
  3.955188082817134*^9, 3.955188270239581*^9, 3.9551883561167727`*^9, 
  3.955436049348619*^9, 3.9554380021184883`*^9, 3.9554385178433723`*^9, 
  3.955439227341412*^9, 3.9554492499850063`*^9, 3.9554494031009483`*^9, 
  3.95544999583285*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"f00148be-8828-4562-8c8a-76638bc34265"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Define", " ", "new", " ", "coordinate", " ", "theta", " ", "as", " ", 
    "length", " ", "and", " ", "angle", " ", "of", " ", 
    RowBox[{"tendon", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"theta0", " ", "=", " ", "l"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"theta1", " ", "=", " ", "alpha"}], ";"}], "\n", 
   RowBox[{"theta", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "theta0", "}"}], ",", " ", 
      RowBox[{"{", "theta1", "}"}]}], "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.950270356097535*^9, 3.9502703615423813`*^9}, {
   3.9507739285686417`*^9, 3.950773929650812*^9}, {3.9507794515543337`*^9, 
   3.950779496891477*^9}, 3.955101333353654*^9, {3.955101372873555*^9, 
   3.9551013766586647`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"399f4c8a-7417-4f17-ae1a-b10830f0d15a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    SqrtBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"xa", "-", 
         RowBox[{"l0", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"q0", "[", "t", "]"}], "]"}]}], "-", 
         RowBox[{"l1", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"q1", "[", "t", "]"}], "]"}]}]}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"ya", "-", 
         RowBox[{"l0", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"q0", "[", "t", "]"}], "]"}]}], "-", 
         RowBox[{"l1", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"q1", "[", "t", "]"}], "]"}]}]}], ")"}], "2"]}]], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"ArcTan", "[", 
     RowBox[{
      RowBox[{"xa", "-", 
       RowBox[{"l0", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"q0", "[", "t", "]"}], "]"}]}], "-", 
       RowBox[{"l1", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"q1", "[", "t", "]"}], "]"}]}]}], ",", 
      RowBox[{"ya", "-", 
       RowBox[{"l0", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"q0", "[", "t", "]"}], "]"}]}], "-", 
       RowBox[{"l1", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"q1", "[", "t", "]"}], "]"}]}]}]}], "]"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.955102601549839*^9, 3.955186589117731*^9, 
  3.955186697494903*^9, 3.955187740167677*^9, 3.955187829013424*^9, 
  3.955188082853323*^9, 3.955188270273398*^9, 3.9551883561508617`*^9, 
  3.9554360493731203`*^9, 3.955438002479298*^9, 3.955438518654907*^9, 
  3.9554392273718367`*^9, 3.955449252483283*^9, 3.955449403948563*^9, 
  3.955449995856738*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"5a3be15f-161e-454f-8f4a-2938c0645f69"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Jacobian", " ", "of", " ", "transform", " ", "from", " ", "q"}],
      " ", "->", " ", "theta"}], ",", " ", 
    RowBox[{"follows", " ", "from", " ", "partial", " ", 
     RowBox[{"derivatives", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Jh", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Simplify", "[", 
         RowBox[{"D", "[", 
          RowBox[{"l", ",", 
           RowBox[{"q", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
        RowBox[{"Simplify", "[", 
         RowBox[{"D", "[", 
          RowBox[{"l", ",", 
           RowBox[{"q", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Simplify", "[", 
         RowBox[{"D", "[", 
          RowBox[{"alpha", ",", 
           RowBox[{"q", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
        RowBox[{"Simplify", "[", 
         RowBox[{"D", "[", 
          RowBox[{"alpha", ",", 
           RowBox[{"q", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], "}"}]}], 
     "}"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.938189465027815*^9, 3.9381894991518993`*^9}, {
   3.93818954763804*^9, 3.938189573423018*^9}, {3.938189609293706*^9, 
   3.938189720756793*^9}, {3.938190395571563*^9, 3.938190398368341*^9}, {
   3.938190473439488*^9, 3.938190475127432*^9}, {3.93911309163839*^9, 
   3.939113104273342*^9}, 3.939185368933867*^9, {3.939383882904419*^9, 
   3.9393838835811577`*^9}, {3.9393839162277117`*^9, 3.939383922341351*^9}, {
   3.9502699763726053`*^9, 3.950269979408366*^9}, {3.950270364471944*^9, 
   3.950270368394758*^9}, {3.95027045107408*^9, 3.950270451949709*^9}, {
   3.950525377801298*^9, 3.950525383939003*^9}, {3.950773933332076*^9, 
   3.9507739345241537`*^9}, {3.9507794232730227`*^9, 
   3.9507794344567013`*^9}, {3.950779508457589*^9, 3.950779555897667*^9}, 
   3.950779769618293*^9, {3.951827226948187*^9, 3.951827235062467*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"648d57b4-0d3c-4163-bb54-fc6e3f2d8e3a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Calculate", " ", "inverse", " ", "and", " ", "inverse", " ", "transpose", 
    " ", "of", " ", 
    RowBox[{"Jacobian", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Jhinv", " ", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{"Inverse", "[", "Jh", "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Jhinvtrans", " ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Transpose", "[", "Jhinv", "]"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.938189751750518*^9, 3.938189842399742*^9}, {
   3.9381899183042183`*^9, 3.938189927504945*^9}, 3.938189988572027*^9, 
   3.938190129638239*^9, {3.9381901906570587`*^9, 3.938190195007268*^9}, {
   3.93819022880756*^9, 3.938190237572562*^9}, {3.9381904953295183`*^9, 
   3.938190504300213*^9}, 3.938190579553447*^9, {3.939124514535918*^9, 
   3.9391245293348427`*^9}, {3.939124634865245*^9, 3.939124639224635*^9}, {
   3.939124732260837*^9, 3.9391247702867327`*^9}, {3.939124801497923*^9, 
   3.9391248063101473`*^9}, {3.939184846201488*^9, 3.9391848906954412`*^9}, {
   3.950774096821772*^9, 3.9507741019972*^9}, {3.950779702708168*^9, 
   3.9507797125676126`*^9}, {3.9507797480045853`*^9, 3.950779760537895*^9}, 
   3.9526766766969967`*^9},
 CellLabel->"In[23]:=",ExpressionUUID->"cfcb8acc-a4ff-49bf-aa6f-1d377e561c85"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"Csc", "[", 
        RowBox[{
         RowBox[{"q0", "[", "t", "]"}], "-", 
         RowBox[{"q1", "[", "t", "]"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "l1"}], "-", 
         RowBox[{"l0", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"q0", "[", "t", "]"}], "-", 
            RowBox[{"q1", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{"xa", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"q1", "[", "t", "]"}], "]"}]}], "+", 
         RowBox[{"ya", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"q1", "[", "t", "]"}], "]"}]}]}], ")"}]}], 
      RowBox[{"l0", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "xa"}], "+", 
            RowBox[{"l0", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"q0", "[", "t", "]"}], "]"}]}], "+", 
            RowBox[{"l1", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"q1", "[", "t", "]"}], "]"}]}]}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "ya"}], "+", 
            RowBox[{"l0", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"q0", "[", "t", "]"}], "]"}]}], "+", 
            RowBox[{"l1", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"q1", "[", "t", "]"}], "]"}]}]}], ")"}], "2"]}]]}]], 
     ",", 
     FractionBox[
      RowBox[{"l0", "-", 
       RowBox[{"ya", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"q1", "[", "t", "]"}], "]"}], " ", 
        RowBox[{"Csc", "[", 
         RowBox[{
          RowBox[{"q0", "[", "t", "]"}], "-", 
          RowBox[{"q1", "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{"xa", " ", 
        RowBox[{"Csc", "[", 
         RowBox[{
          RowBox[{"q0", "[", "t", "]"}], "-", 
          RowBox[{"q1", "[", "t", "]"}]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"q1", "[", "t", "]"}], "]"}]}]}], "l0"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"Csc", "[", 
        RowBox[{
         RowBox[{"q0", "[", "t", "]"}], "-", 
         RowBox[{"q1", "[", "t", "]"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"l0", "-", 
         RowBox[{"xa", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"q0", "[", "t", "]"}], "]"}]}], "+", 
         RowBox[{"l1", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"q0", "[", "t", "]"}], "-", 
            RowBox[{"q1", "[", "t", "]"}]}], "]"}]}], "-", 
         RowBox[{"ya", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"q0", "[", "t", "]"}], "]"}]}]}], ")"}]}], 
      RowBox[{"l1", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "xa"}], "+", 
            RowBox[{"l0", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"q0", "[", "t", "]"}], "]"}]}], "+", 
            RowBox[{"l1", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"q1", "[", "t", "]"}], "]"}]}]}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "ya"}], "+", 
            RowBox[{"l0", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"q0", "[", "t", "]"}], "]"}]}], "+", 
            RowBox[{"l1", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"q1", "[", "t", "]"}], "]"}]}]}], ")"}], "2"]}]]}]], 
     ",", 
     FractionBox[
      RowBox[{"l1", "+", 
       RowBox[{"ya", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"q0", "[", "t", "]"}], "]"}], " ", 
        RowBox[{"Csc", "[", 
         RowBox[{
          RowBox[{"q0", "[", "t", "]"}], "-", 
          RowBox[{"q1", "[", "t", "]"}]}], "]"}]}], "-", 
       RowBox[{"xa", " ", 
        RowBox[{"Csc", "[", 
         RowBox[{
          RowBox[{"q0", "[", "t", "]"}], "-", 
          RowBox[{"q1", "[", "t", "]"}]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"q0", "[", "t", "]"}], "]"}]}]}], "l1"]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.95510260225898*^9, 3.9551865900232058`*^9, 
  3.955186698253891*^9, 3.955187740974868*^9, 3.955187830064374*^9, 
  3.955188083589219*^9, 3.9551882710300617`*^9, 3.9551883569386053`*^9, 
  3.955436050296464*^9, 3.955438003891796*^9, 3.955438522301422*^9, 
  3.955439228119226*^9, 3.955449254720787*^9, 3.955449406430482*^9, 
  3.955449996581897*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"bda42928-2d8c-4e4e-bf12-c8d92a69bd9a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"The", " ", "Lagrangian", " ", 
    RowBox[{"(", "L", ")"}], " ", "is", " ", "defined", " ", "as", " ", "the",
     " ", "difference", " ", "between", " ", "kinetic", " ", 
    RowBox[{"(", "T", ")"}], " ", "and", " ", "potential", " ", 
    RowBox[{"(", "V", ")"}], " ", "energy"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"T", "=", 
     RowBox[{"0.5", "*", "m", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"vx1", "^", "2"}], "+", 
        RowBox[{"vy1", "^", "2"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"V", "=", 
     RowBox[{
      RowBox[{"m", "*", "g", "*", "y1"}], " ", "-", " ", 
      RowBox[{"0.5", "*", "k", "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"q1", "[", "t", "]"}], "-", 
          RowBox[{"q0", "[", "t", "]"}]}], ")"}], "^", "2"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"L", "=", 
    RowBox[{"T", "-", "V"}]}]}]}]], "Input",
 CellChangeTimes->{{3.939113355096916*^9, 3.939113362993724*^9}, {
   3.93911499257547*^9, 3.939115007924464*^9}, 3.939115671219817*^9, {
   3.939118576169607*^9, 3.939118581902507*^9}, {3.9507777190510387`*^9, 
   3.9507777497601137`*^9}, 3.950779838046164*^9, {3.9544874959006844`*^9, 
   3.954487499918091*^9}, {3.955102561612705*^9, 3.9551025834476337`*^9}, {
   3.9551026162287903`*^9, 3.955102616752598*^9}, {3.955102692191305*^9, 
   3.9551026937170753`*^9}, {3.955186679480296*^9, 3.955186684629088*^9}, {
   3.955187716698316*^9, 3.955187718414627*^9}, {3.955187808540271*^9, 
   3.9551878095974827`*^9}, {3.955188043429399*^9, 3.955188045855364*^9}, {
   3.955188257502043*^9, 3.9551882594146967`*^9}, {3.95518834279568*^9, 
   3.955188343528886*^9}, {3.955188816834882*^9, 3.955188831974221*^9}, {
   3.955437977209717*^9, 3.955437982380741*^9}, {3.955438498594429*^9, 
   3.955438498977309*^9}, {3.955439083064354*^9, 3.9554390831841507`*^9}, {
   3.955449377152842*^9, 3.955449379944296*^9}, {3.95544993922639*^9, 
   3.955449940297023*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"8153d1cc-18d3-4975-9e09-50828f4d9c8e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"0.5`", " ", "k", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"q0", "[", "t", "]"}]}], "+", 
      RowBox[{"q1", "[", "t", "]"}]}], ")"}], "2"]}], "-", 
  RowBox[{"g", " ", "m", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"l0", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"q0", "[", "t", "]"}], "]"}]}], "+", 
     RowBox[{"l1", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"q1", "[", "t", "]"}], "]"}]}]}], ")"}]}], "+", 
  RowBox[{"0.5`", " ", "m", " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"l0", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"q0", "[", "t", "]"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["q0", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "+", 
        RowBox[{"l1", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"q1", "[", "t", "]"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["q1", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "l0"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"q0", "[", "t", "]"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["q0", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "-", 
        RowBox[{"l1", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"q1", "[", "t", "]"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["q1", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], ")"}], "2"]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.955102602368783*^9, 3.955102694335021*^9, 3.955186590126927*^9, 
   3.955186698305402*^9, 3.95518774102185*^9, 3.955187830138597*^9, 
   3.9551880836377974`*^9, 3.955188271082594*^9, 3.9551883569928007`*^9, {
   3.955188819870638*^9, 3.955188826202188*^9}, 3.955436050390265*^9, 
   3.955438004532638*^9, {3.955438499689468*^9, 3.955438524439179*^9}, 
   3.9554390842718277`*^9, 3.955439228177854*^9, 3.9554492553144608`*^9, {
   3.95544938058848*^9, 3.9554494070453587`*^9}, 3.955449940969672*^9, 
   3.955449996850203*^9},
 CellLabel->"Out[27]=",ExpressionUUID->"f8bf625c-6cb4-445a-aa73-665adf70a7a1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"The", " ", "matrix", " ", "G", 
     RowBox[{"(", "q", ")"}], " ", "captures", " ", "potential", " ", 
     "forces"}], ",", " ", 
    RowBox[{
    "which", " ", "follow", " ", "from", " ", "the", " ", "derivative", " ", 
     "of", " ", "potential", " ", "terms"}]}], "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{"Gq", " ", "=", " ", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"V", ",", " ", 
         RowBox[{"q", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "2"}], "}"}]}], "]"}], "}"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.939123576460088*^9, 3.939123649005788*^9}, {
  3.950777384779839*^9, 3.950777418442546*^9}, {3.952588201718433*^9, 
  3.9525882075588627`*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"f85ad32a-8184-4771-8710-cb4c8a63e501"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"g", " ", "l0", " ", "m", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"q0", "[", "t", "]"}], "]"}]}], "+", 
     RowBox[{"1.`", " ", "k", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"q0", "[", "t", "]"}]}], "+", 
        RowBox[{"q1", "[", "t", "]"}]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"g", " ", "l1", " ", "m", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"q1", "[", "t", "]"}], "]"}]}], "-", 
     RowBox[{"1.`", " ", "k", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"q0", "[", "t", "]"}]}], "+", 
        RowBox[{"q1", "[", "t", "]"}]}], ")"}]}]}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{
  3.955102602390171*^9, 3.9551026952293863`*^9, 3.9551865901559143`*^9, 
   3.9551866983290052`*^9, 3.955187741058957*^9, 3.955187830192358*^9, 
   3.955188083667622*^9, 3.955188271117463*^9, 3.9551883570227537`*^9, 
   3.955436050415072*^9, {3.9554380058382874`*^9, 3.955438009813724*^9}, {
   3.955438527783083*^9, 3.9554385298779287`*^9}, {3.955439085649048*^9, 
   3.9554390898296623`*^9}, 3.9554392282073393`*^9, 3.9554492563335133`*^9, {
   3.955449383074665*^9, 3.955449408076151*^9}, 3.95544994226791*^9, 
   3.955449996902319*^9},
 CellLabel->"Out[28]=",ExpressionUUID->"2578a3c8-505f-487d-8a4e-7467156720a0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Gth", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Dot", "[", 
    RowBox[{"Jhinvtrans", ",", " ", "Gq"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.951898423853106*^9, 3.951898437013452*^9}, {
  3.9526812376442213`*^9, 3.952681239671562*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"6d1d8159-f589-4253-a206-9b07ad8c34e6"],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{
        RowBox[{"csc", "(", 
         RowBox[{
          RowBox[{"q0", "(", "t", ")"}], "-", 
          RowBox[{"q1", "(", "t", ")"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"g", " ", "l1", " ", "m", " ", 
               RowBox[{"cos", "(", 
                RowBox[{"q1", "(", "t", ")"}], ")"}]}], "+", 
              RowBox[{"1.`", " ", "k", " ", 
               RowBox[{"q0", "(", "t", ")"}]}], "-", 
              RowBox[{"1.`", " ", "k", " ", 
               RowBox[{"q1", "(", "t", ")"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"l0", "+", 
              RowBox[{"l1", " ", 
               RowBox[{"cos", "(", 
                RowBox[{
                 RowBox[{"q0", "(", "t", ")"}], "-", 
                 RowBox[{"q1", "(", "t", ")"}]}], ")"}]}], "-", 
              RowBox[{"1.`", " ", "xa", " ", 
               RowBox[{"cos", "(", 
                RowBox[{"q0", "(", "t", ")"}], ")"}]}], "-", 
              RowBox[{"1.`", " ", "ya", " ", 
               RowBox[{"sin", "(", 
                RowBox[{"q0", "(", "t", ")"}], ")"}]}]}], ")"}]}], "l1"], "+", 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"g", " ", "l0", " ", "m", " ", 
               RowBox[{"cos", "(", 
                RowBox[{"q0", "(", "t", ")"}], ")"}]}], "-", 
              RowBox[{"1.`", " ", "k", " ", 
               RowBox[{"q0", "(", "t", ")"}]}], "+", 
              RowBox[{"1.`", " ", "k", " ", 
               RowBox[{"q1", "(", "t", ")"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"l0", " ", 
                RowBox[{"cos", "(", 
                 RowBox[{
                  RowBox[{"q0", "(", "t", ")"}], "-", 
                  RowBox[{"q1", "(", "t", ")"}]}], ")"}]}]}], "-", "l1", "+", 
              
              RowBox[{"xa", " ", 
               RowBox[{"cos", "(", 
                RowBox[{"q1", "(", "t", ")"}], ")"}]}], "+", 
              RowBox[{"ya", " ", 
               RowBox[{"sin", "(", 
                RowBox[{"q1", "(", "t", ")"}], ")"}]}]}], ")"}]}], "l0"]}], 
         ")"}]}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"l0", " ", 
             RowBox[{"cos", "(", 
              RowBox[{"q0", "(", "t", ")"}], ")"}]}], "+", 
            RowBox[{"l1", " ", 
             RowBox[{"cos", "(", 
              RowBox[{"q1", "(", "t", ")"}], ")"}]}], "-", "xa"}], ")"}], 
          "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"l0", " ", 
             RowBox[{"sin", "(", 
              RowBox[{"q0", "(", "t", ")"}], ")"}]}], "+", 
            RowBox[{"l1", " ", 
             RowBox[{"sin", "(", 
              RowBox[{"q1", "(", "t", ")"}], ")"}]}], "-", "ya"}], ")"}], 
          "2"]}]]]},
     {
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"g", " ", "l0", " ", "m", " ", 
            RowBox[{"cos", "(", 
             RowBox[{"q0", "(", "t", ")"}], ")"}]}], "-", 
           RowBox[{"1.`", " ", "k", " ", 
            RowBox[{"q0", "(", "t", ")"}]}], "+", 
           RowBox[{"1.`", " ", "k", " ", 
            RowBox[{"q1", "(", "t", ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"l0", "+", 
           RowBox[{"xa", " ", 
            RowBox[{"sin", "(", 
             RowBox[{"q1", "(", "t", ")"}], ")"}], " ", 
            RowBox[{"csc", "(", 
             RowBox[{
              RowBox[{"q0", "(", "t", ")"}], "-", 
              RowBox[{"q1", "(", "t", ")"}]}], ")"}]}], "-", 
           RowBox[{"1.`", " ", "ya", " ", 
            RowBox[{"cos", "(", 
             RowBox[{"q1", "(", "t", ")"}], ")"}], " ", 
            RowBox[{"csc", "(", 
             RowBox[{
              RowBox[{"q0", "(", "t", ")"}], "-", 
              RowBox[{"q1", "(", "t", ")"}]}], ")"}]}]}], ")"}]}], "l0"], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"g", " ", "l1", " ", "m", " ", 
            RowBox[{"cos", "(", 
             RowBox[{"q1", "(", "t", ")"}], ")"}]}], "+", 
           RowBox[{"1.`", " ", "k", " ", 
            RowBox[{"q0", "(", "t", ")"}]}], "-", 
           RowBox[{"1.`", " ", "k", " ", 
            RowBox[{"q1", "(", "t", ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"l1", "-", 
           RowBox[{"1.`", " ", "xa", " ", 
            RowBox[{"sin", "(", 
             RowBox[{"q0", "(", "t", ")"}], ")"}], " ", 
            RowBox[{"csc", "(", 
             RowBox[{
              RowBox[{"q0", "(", "t", ")"}], "-", 
              RowBox[{"q1", "(", "t", ")"}]}], ")"}]}], "+", 
           RowBox[{"ya", " ", 
            RowBox[{"cos", "(", 
             RowBox[{"q0", "(", "t", ")"}], ")"}], " ", 
            RowBox[{"csc", "(", 
             RowBox[{
              RowBox[{"q0", "(", "t", ")"}], "-", 
              RowBox[{"q1", "(", "t", ")"}]}], ")"}]}]}], ")"}]}], "l1"]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.9551026026636963`*^9, 3.955102608283739*^9}, {
   3.955102695835743*^9, 3.9551026988652697`*^9}, 3.95518659023039*^9, 
   3.955186698557273*^9, 3.9551877411663923`*^9, 3.955187831017914*^9, 
   3.955188083892427*^9, 3.955188271201523*^9, 3.955188357311768*^9, 
   3.9554360506967897`*^9, 3.955438143279675*^9, 3.9554390927945833`*^9, 
   3.955439228426609*^9, 3.955449257515092*^9, 3.955449409360993*^9, 
   3.955449997177511*^9, 3.955530156591621*^9},
 CellLabel->"Out[29]=",ExpressionUUID->"d599e7f2-4d9f-4bec-8129-6ab7c7b17a82"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"dGthdth0", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Jhinv", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], "*", 
       RowBox[{"D", "[", 
        RowBox[{"Gth", ",", 
         RowBox[{"{", 
          RowBox[{"q", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "q", "]"}]}], "}"}]}], "]"}], "//", 
    "Simplify"}]}], ";"}]], "Input",
 CellChangeTimes->{3.955344224927483*^9},
 CellLabel->"In[30]:=",ExpressionUUID->"bf9d4c7c-cf88-4595-82db-5b12d8c35297"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dGthdth1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Jhinv", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "2"}], "]"}], "]"}], "*", 
       RowBox[{"D", "[", 
        RowBox[{"Gth", ",", 
         RowBox[{"{", 
          RowBox[{"q", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "q", "]"}]}], "}"}]}], "]"}], "//", 
    "Simplify"}]}], ";"}]], "Input",
 CellChangeTimes->{3.955344222874655*^9},
 CellLabel->"In[31]:=",ExpressionUUID->"41084389-3faf-41e5-861f-d646b011ee40"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"ddGthddth0", " ", "=", " ", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Jhinv", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], "*", 
       RowBox[{"D", "[", 
        RowBox[{"dGthdth0", ",", 
         RowBox[{"{", 
          RowBox[{"q", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "q", "]"}]}], "}"}]}], "]"}], "//", 
    "Simplify"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.955187731304105*^9, 3.955187732947537*^9}, {
  3.955188075585218*^9, 3.9551880756844263`*^9}, {3.955188186363881*^9, 
  3.9551881864396*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"3ef5d3a2-b8f1-44d1-b124-3f74b8344305"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"ddGthdth0dth1", " ", "=", " ", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Jhinv", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], "*", 
       RowBox[{"D", "[", 
        RowBox[{"dGthdth1", ",", 
         RowBox[{"{", 
          RowBox[{"q", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "q", "]"}]}], "}"}]}], "]"}], "//", 
    "Simplify"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.955188057728621*^9, 3.955188058786314*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"6ae6d879-a512-4a35-817d-2554ef1fef48"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"ddGthddth1", " ", "=", " ", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Jhinv", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "2"}], "]"}], "]"}], "*", 
       RowBox[{"D", "[", 
        RowBox[{"dGthdth1", ",", 
         RowBox[{"{", 
          RowBox[{"q", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "q", "]"}]}], "}"}]}], "]"}], "//", 
    "Simplify"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.955188061290265*^9, 3.955188061377924*^9}, {
  3.955188190889337*^9, 3.9551881909191837`*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"fd36a1bb-0488-4e53-8739-dffc1afde852"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"l0", " ", "=", " ", "3.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l1", " ", "=", " ", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xa", " ", "=", " ", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ya", " ", "=", " ", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m", " ", "=", " ", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", " ", "=", " ", "9.81"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k", " ", "=", " ", "0.5"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"q0", "[", "t", "]"}], " ", "=", " ", 
   RowBox[{"-", "1.5615003108978271"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"q1", "[", "t", "]"}], " ", "=", " ", "0.32742762565612793"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.955187482880741*^9, 3.955187549548806*^9}, {
   3.95518760426934*^9, 3.955187614191722*^9}, {3.955447471253718*^9, 
   3.95544747717522*^9}, {3.9554485561177607`*^9, 3.95544859181854*^9}, {
   3.9554492736456823`*^9, 3.9554492830711803`*^9}, {3.95544934533421*^9, 
   3.9554493497119904`*^9}, {3.9554499213444033`*^9, 3.955449927656782*^9}, 
   3.955450087051104*^9},
 CellLabel->"In[64]:=",ExpressionUUID->"c85ecf09-5e1b-43f9-b560-4f58a1bd4da3"],

Cell[BoxData["0.5`"], "Output",
 CellChangeTimes->{{3.9551875379697933`*^9, 3.955187550636094*^9}, 
   3.95518761507966*^9, 3.9551877420716267`*^9, 3.955187926687828*^9, 
   3.955188141888742*^9, 3.9551882190751743`*^9, 3.9551882717413816`*^9, 
   3.955188417396645*^9, 3.955436116340176*^9, 3.9554381724359407`*^9, 
   3.955439153784157*^9, 3.955439291638371*^9, 3.9554474793459253`*^9, 
   3.9554485931415243`*^9, {3.955449318885042*^9, 3.955449321303763*^9}, 
   3.9554493584460497`*^9, 3.955449415610229*^9, 3.955449928255674*^9, {
   3.955450057346547*^9, 3.955450087560041*^9}},
 CellLabel->"Out[70]=",ExpressionUUID->"740dbcb7-dfc2-474e-a13e-f9b301ca413d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Gq: \>\"", ",", " ", "Gq"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<G0: \>\"", ",", " ", 
   RowBox[{"Gth", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<G1: \>\"", ",", " ", 
   RowBox[{"Gth", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<dG1dth0: \>\"", ",", " ", 
   RowBox[{"dGthdth0", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<dG1dth1: \>\"", ",", " ", 
   RowBox[{"dGthdth1", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.955187504464595*^9, 3.9551875065553503`*^9}, {
  3.955187619082745*^9, 3.955187620451935*^9}, {3.9554379398229103`*^9, 
  3.9554379432226048`*^9}, {3.9554481681249733`*^9, 3.955448240819298*^9}, {
  3.955448345358872*^9, 3.9554483538537407`*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"22795a01-d8f1-4667-8dc4-d9bdbbd4b50a"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Gq: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1.7925551717287629`", "}"}], ",", 
     RowBox[{"{", "54.78846742403716`", "}"}]}], "}"}]}],
  SequenceForm["Gq: ", {{1.7925551717287629`}, {54.78846742403716}}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.95544819430297*^9, 3.955448241762031*^9}, 
   3.9554483982270737`*^9, 3.955448594450939*^9, 3.955449325668234*^9, 
   3.9554493594464493`*^9, 3.955449417240391*^9, 3.955449929634417*^9, {
   3.955450057376474*^9, 3.955450088470265*^9}},
 CellLabel->
  "During evaluation of \
In[73]:=",ExpressionUUID->"70690323-a3c6-4dcd-b192-9cf8516431bf"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"G0: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"-", "29.03763756602362`"}], "}"}]}],
  SequenceForm["G0: ", {-29.03763756602362}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.95544819430297*^9, 3.955448241762031*^9}, 
   3.9554483982270737`*^9, 3.955448594450939*^9, 3.955449325668234*^9, 
   3.9554493594464493`*^9, 3.955449417240391*^9, 3.955449929634417*^9, {
   3.955450057376474*^9, 3.955450088472238*^9}},
 CellLabel->
  "During evaluation of \
In[73]:=",ExpressionUUID->"3bf800a9-388f-401d-bcf1-123ea7af69f8"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"G1: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "0.050728572465741806`", "}"}]}],
  SequenceForm["G1: ", {0.050728572465741806`}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.95544819430297*^9, 3.955448241762031*^9}, 
   3.9554483982270737`*^9, 3.955448594450939*^9, 3.955449325668234*^9, 
   3.9554493594464493`*^9, 3.955449417240391*^9, 3.955449929634417*^9, {
   3.955450057376474*^9, 3.95545008847375*^9}},
 CellLabel->
  "During evaluation of \
In[73]:=",ExpressionUUID->"468c8ed7-8e35-41d5-b5da-ec7bc3a6321c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"dG1dth0: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"-", "0.8209367090555768`"}], "}"}]}],
  SequenceForm["dG1dth0: ", {-0.8209367090555768}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.95544819430297*^9, 3.955448241762031*^9}, 
   3.9554483982270737`*^9, 3.955448594450939*^9, 3.955449325668234*^9, 
   3.9554493594464493`*^9, 3.955449417240391*^9, 3.955449929634417*^9, {
   3.955450057376474*^9, 3.955450088474637*^9}},
 CellLabel->
  "During evaluation of \
In[73]:=",ExpressionUUID->"1eb8182b-b64a-4fc6-8746-bb6c123ad38c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"dG1dth1: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "220.51876004539457`", "}"}]}],
  SequenceForm["dG1dth1: ", {220.51876004539457`}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.95544819430297*^9, 3.955448241762031*^9}, 
   3.9554483982270737`*^9, 3.955448594450939*^9, 3.955449325668234*^9, 
   3.9554493594464493`*^9, 3.955449417240391*^9, 3.955449929634417*^9, {
   3.955450057376474*^9, 3.955450088475491*^9}},
 CellLabel->
  "During evaluation of \
In[73]:=",ExpressionUUID->"9ae1b7ba-bb21-4394-92f2-313fd88433da"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"m", "*", "g", "*", 
  RowBox[{"theta", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "*", 
  RowBox[{"Cos", "[", 
   RowBox[{"theta", "[", 
    RowBox[{"[", "2", "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.955449569123501*^9, 3.955449618591262*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"9c6e43f0-5d2d-499e-b1bb-e1e4225e14d2"],

Cell[BoxData[
 RowBox[{"{", "2.2789774042340833`", "}"}]], "Output",
 CellChangeTimes->{{3.955449593351942*^9, 3.955449619185576*^9}, 
   3.955450057557773*^9},
 CellLabel->"Out[49]=",ExpressionUUID->"23fcaa9c-655e-4897-abae-90c453014973"]
}, Open  ]]
},
WindowSize->{1386, 762},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"14.1 for Linux x86 (64-bit) (July 16, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"7fa65ef8-2d93-47c1-8861-3a250912491a"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 1244, 33, 73, "Input",ExpressionUUID->"47abae8b-9a77-408c-b4af-bc57d2c86ead"],
Cell[1801, 55, 1607, 46, 109, "Input",ExpressionUUID->"d318ab64-df89-41e4-88c1-260881541004"],
Cell[3411, 103, 934, 28, 109, "Input",ExpressionUUID->"610ec9d0-2acf-46c2-8994-20be09315927"],
Cell[CellGroupData[{
Cell[4370, 135, 2638, 60, 198, "Input",ExpressionUUID->"9eec63cc-bd4b-4469-8473-5eea612c1986"],
Cell[7011, 197, 1023, 25, 34, "Output",ExpressionUUID->"f00148be-8828-4562-8c8a-76638bc34265"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8071, 227, 930, 21, 91, "Input",ExpressionUUID->"399f4c8a-7417-4f17-ae1a-b10830f0d15a"],
Cell[9004, 250, 1779, 49, 39, "Output",ExpressionUUID->"5a3be15f-161e-454f-8f4a-2938c0645f69"]
}, Open  ]],
Cell[10798, 302, 2203, 50, 49, "Input",ExpressionUUID->"648d57b4-0d3c-4163-bb54-fc6e3f2d8e3a"],
Cell[CellGroupData[{
Cell[13026, 356, 1384, 26, 69, "Input",ExpressionUUID->"cfcb8acc-a4ff-49bf-aa6f-1d377e561c85"],
Cell[14413, 384, 4714, 133, 120, "Output",ExpressionUUID->"bda42928-2d8c-4e4e-bf12-c8d92a69bd9a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19164, 522, 2165, 45, 89, "Input",ExpressionUUID->"8153d1cc-18d3-4975-9e09-50828f4d9c8e"],
Cell[21332, 569, 2340, 62, 34, "Output",ExpressionUUID->"f8bf625c-6cb4-445a-aa73-665adf70a7a1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23709, 636, 998, 26, 51, "Input",ExpressionUUID->"f85ad32a-8184-4771-8710-cb4c8a63e501"],
Cell[24710, 664, 1418, 35, 34, "Output",ExpressionUUID->"2578a3c8-505f-487d-8a4e-7467156720a0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26165, 704, 363, 7, 30, "Input",ExpressionUUID->"6d1d8159-f589-4253-a206-9b07ad8c34e6"],
Cell[26531, 713, 6223, 157, 91, "Output",ExpressionUUID->"d599e7f2-4d9f-4bec-8129-6ab7c7b17a82"]
}, Open  ]],
Cell[32769, 873, 679, 20, 29, "Input",ExpressionUUID->"bf9d4c7c-cf88-4595-82db-5b12d8c35297"],
Cell[33451, 895, 679, 20, 29, "Input",ExpressionUUID->"41084389-3faf-41e5-861f-d646b011ee40"],
Cell[34133, 917, 825, 22, 29, "Input",ExpressionUUID->"3ef5d3a2-b8f1-44d1-b124-3f74b8344305"],
Cell[34961, 941, 730, 20, 29, "Input",ExpressionUUID->"6ae6d879-a512-4a35-817d-2554ef1fef48"],
Cell[35694, 963, 778, 21, 29, "Input",ExpressionUUID->"fd36a1bb-0488-4e53-8739-dffc1afde852"],
Cell[CellGroupData[{
Cell[36497, 988, 1321, 30, 209, "Input",ExpressionUUID->"c85ecf09-5e1b-43f9-b560-4f58a1bd4da3"],
Cell[37821, 1020, 663, 9, 33, "Output",ExpressionUUID->"740dbcb7-dfc2-474e-a13e-f9b301ca413d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38521, 1034, 1084, 23, 120, "Input",ExpressionUUID->"22795a01-d8f1-4667-8dc4-d9bdbbd4b50a"],
Cell[CellGroupData[{
Cell[39630, 1061, 687, 15, 23, "Print",ExpressionUUID->"70690323-a3c6-4dcd-b192-9cf8516431bf"],
Cell[40320, 1078, 588, 13, 23, "Print",ExpressionUUID->"3bf800a9-388f-401d-bcf1-123ea7af69f8"],
Cell[40911, 1093, 573, 12, 23, "Print",ExpressionUUID->"468c8ed7-8e35-41d5-b5da-ec7bc3a6321c"],
Cell[41487, 1107, 600, 13, 23, "Print",ExpressionUUID->"1eb8182b-b64a-4fc6-8746-bb6c123ad38c"],
Cell[42090, 1122, 580, 12, 23, "Print",ExpressionUUID->"9ae1b7ba-bb21-4394-92f2-313fd88433da"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[42719, 1140, 358, 8, 29, "Input",ExpressionUUID->"9c6e43f0-5d2d-499e-b1bb-e1e4225e14d2"],
Cell[43080, 1150, 239, 4, 33, "Output",ExpressionUUID->"23fcaa9c-655e-4897-abae-90c453014973"]
}, Open  ]]
}
]
*)

